# Project Notes: Lineage Structure and Sequencing Rules

This document records conceptual decisions that must be resolved before resilience metrics are finalized.

---

## Motivation

SAV lineages derived from patch tracking are not guaranteed to form simple, linear time series. Patch splits and merges can produce branching structures analogous to phylogenetic trees.

Because resilience metrics depend on temporal structure, it is necessary to explicitly define how lineage dynamics are represented before computing persistence, memory, stability, regimes, or synchrony.

---

## Lineage representation

Lineages may include:
- continuation across years
- split events (one lineage producing multiple descendants)
- merge events (multiple lineages converging)
- termination events

These relationships imply a graph structure rather than a single chain.

---

## Planned diagnostic outputs

Before freezing sequencing rules, the project will generate:

- a lineage graph representation
- counts of split, merge, continuation, and termination events
- summaries of lineage depth and branching frequency

These outputs are generated by `n0_03_build_lineage_graph_qc`.

---

## Sequencing options under consideration

Metrics may be computed using one of the following approaches:

1. **Trunk-based sequences**  
   Focus on dominant or longest paths through the lineage graph.

2. **Segment-based sequences**  
   Treat segments between split/merge events as independent sequences.

3. **Graph-based summaries**  
   Compute metrics directly on lineage graphs rather than linearized sequences.

The selected approach will be documented here and referenced by all downstream scripts.

---

## Freeze rule

Once a sequencing rule is selected:
- it is applied consistently across all metrics
- it is not changed mid-analysis
- any alternative representations are treated as separate sensitivity analyses

This document serves as the permanent record of that decision.